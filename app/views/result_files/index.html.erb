<h1>Listing Result Files for <%=h current_user.lab.lab_name %></h1>

<% @result_files.each do |rfile| %>
  <% @sample_codes = [] %>
  <% next if rfile.seq_lanes.blank? %>
  <strong>Document Name: <%= link_to rfile.document, rfile %></strong>  
    <% rfile.seq_lanes.each do |lane| %>
    <ul>
      <li>Seq Run #: <%= lane.seq_run_nr %></li>
      <li>Lane #: <%= lane.lane_nr %></li>
      <li>Sample Info: 
      <% @sample_codes.push(lane.sample.barcode_key) if (!@sample_codes.include?(lane.sample.barcode_key)) %>
        <ul>
          <li>Name - <%= lane.sample.sample_name %></li>
          <li>Barcode - <%= lane.sample.barcode_key %></li>
          <% unless lane.sample.sc_marker_validation_method.blank? %>
          <li>SC Marker Validation - <%= lane.sample.sc_marker_validation_method %></li>         
          <% end %>
		  <% if !@fastqc_files.blank? %>        
            <% @fastqc_files.each do |file| %>         
              <% if (!file.blank? && file.match(lane.sample.barcode_key + '_fastqc')) %> 
              <li><%= link_to "FastQC Report", fastqc_show_path(:file_path => file) %></li>
              <% end %>                      
           <% end %>
		 <% end %>          
        </ul>
      </li>
    </ul>
    <% end %> <!-- /seq lanes do -->
  <strong>Notes:</strong> <%= rfile.notes %><br />
  <hr />
<% end %> <!-- /result files do -->