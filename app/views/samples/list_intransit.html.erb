<script type="text/javascript">
<!--


//-->
</script>


<h1>Samples in transit</h1>

<% form_tag :action => :update_multi do %>
<table class="list">
  <tr>
    <th>Recvd?</th>
    <th>Date Received</th>
    <th>Lab Name</th>
    <th>Barcode</th>
    <th>Sample Name</th>
    <th>Sample Date</th>
    <th>Date Shipped</th>
    <th>FedEx Tracking#</th>
    <th>Shipping Comments</th>
  </tr>

<% @samples.each_with_index do |sample, i| %>
  <% if sample.shipment %>
  <% fields_for "sample[" + sample.id.to_s + "]", sample do |f| %>
  <% check_box_id   = "sample_" + sample.id.to_s %>
 
  <tr>
    <td><%= check_box_tag(check_box_id) %></td>
						 
    <script type="text/javascript">
      var mm = new Array("01", "02", "03","04", "05", "06", "07", "08", "09","10", "11", "12");
      var full_date = new Date();
      var curr_date = full_date.getDate();
      var curr_month = full_date.getMonth();
      var curr_year = full_date.getFullYear();
      var num_date = curr_year + "-" + mm[curr_month] + "-" + curr_date;
      jQuery(function(){
          $j('#<%= check_box_id %>').click(function() {
              $j('#<%= check_box_id %>_shipment_attributes_date_received').val(num_date);
          });
      });
    </script>						  

    <% f.fields_for :shipment do |s| %>
    <td><%=s.calendar_date_select(:date_received, :valid_date_check => "date <= (new Date()).stripTime()", :year_range => [1.years.ago, 0.years.ago], :size => 15)%></td>
    <td><%=h sample.lab.lab_name %></td>
    <td><%=link_to sample.barcode_key, sample %></td>
    <td><%=h sample.sample_name %></td>
    <td><%=h sample.sample_date %></td>
    <td><%=h sample.shipment.date_shipped %></td>
    <td><%=h sample.shipment.fedex_tracking_nr %></td>
    <td><%=h sample.shipment.comments %></td>
  </tr>
  <% end %>
  <% end %>
<% end %>
<% end %>
</table>
<%= submit_tag 'Update'%>
<% end %>
<%= link_to 'List All', samples_path %>


